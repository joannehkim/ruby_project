<!DOCTYPE html>
<html>
<head>
  <title></title>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href='https://fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet' type='text/css'>
  <script type="text/javascript">
  $(document).ready(function() {
    $('.datepicker').pickadate({
    selectMonths: true, // Creates a dropdown to control month
    selectYears: 15 // Creates a dropdown of 15 years to control year
  });
  });
  </script>
</head>
<body>

<section class="module content">
  <div class="container">
      <table>
        <thead>
        	<% if @trip.picture_file_name %>
				<h3>Trip Album Cover</h3>
				<div class = 'place_image'><%= image_tag @trip.picture.url  %></div>
			<% end %>
          <tr>
              <th data-field="id">Name</th>
              <td><%= @trip.user.first_name %> <%= @trip.user.last_name %></td>
          </tr>
          <tr>
              <th data-field="id">Destination</th>
              <td><%= @trip.destination %></td>
          </tr>
          <tr>
              <th data-field="id">Description</th>
              <td><%= @trip.description %></td>
          </tr>
          <tr>
              <th data-field="id">Trip Date</th>
              <td><%= @trip.start_date.to_date %> ~ <%= @trip.end_date.to_date %></td>
          </tr>
        </thead>
          <% if Like.find_by(user_id: current_user.id, likeable_id: @trip.id, likeable_type: "Trip") %>
		    <form action='/likes' method='POST'>
		      <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
		      <input name = "_method" value = 'delete' type = 'hidden'>
		      <input name="likeable_id" value="<%= @trip.id %>" type="hidden">
		      <input name="likeable_type" value= "Trip" type="hidden">
		      <input type="submit" value="Unlike">
		    </form>
		  <% else %>
		    <form action='/likes' method='POST'>
		      <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
		      <input name="likeable_id" value="<%= @trip.id %>" type="hidden">
		      <input name="likeable_type" value="Trip" type="hidden">
		      <input type="submit" value="Like">
		    </form>
		  <% end %>
  <b>There are <%= Like.where(likeable_type: "Trip", likeable_id: @trip.id).count %> users who like this trip.</b>
      </table>

    <h4>Comments:</h4>
    <% @comments.each do |c| %>
      <%= c.content %><br>
      - <%= c.user.first_name %>
    <% end %>
    <form action='/comments' method='POST'>
      <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
      <input name = "comment[content]" type = 'text' value='Add a Comment'>
      <input name="comment[commentable_id]" value="<%= @trip.id %>" type="hidden">
      <input name="comment[commentable_type]" value="Trip" type="hidden">
      <button type="submit" class="waves-effect waves-light btn-large">Post</button>
    </form>
    <% if current_user.id == @trip.user_id %>
      <center>
      <h3>Add a Place:</h3>
        <div class="row">
          <form class="col s9" action="/places" method="POST">
            <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
            <input name = "place[trip_id]" value = "<%= @trip.id %>" type = 'hidden'>
            <div class="container">
            <div class="row">
              <div class="input-field col s9">
                <i class="material-icons prefix">language</i>
                <input id="icon_prefix" type="text" class="validate" name="place[location]">
                <label for="icon_prefix">Location</label>
              </div><br>
              <div class="input-field col s9">
                <i class="material-icons prefix">mode_edit</i>
                <input id="icon_telephone" type="tel" class="validate" name="place[description]">
                <label for="icon_telephone">Description</label>
              </div>
              <div class="input-field col s9">
                <i class="material-icons prefix">toc</i>
                <input id="date" type="date" class="datepicker" name="place[datetime]">
                <label for="date">Date</label>
              </div>
            </div>
            </div>
            <button type="submit" class="waves-effect waves-light btn-large">Add Place</button>
          </form>
        </div>
  <div class="row">
  <form class="new_picture" id="new_picture" enctype="multipart/form-data" action="/trips/<%= @trip.id %>" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="âœ“">
    <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
    <input type = 'hidden' name = '_method' value = 'patch'>
    <div class="file-field input-field">
      <div class="btn">
        <span>File</span>
      <input type="file" name="trip[picture]" id="picture_picture">
      </div>
      <div class="file-path-wrapper">
        <input class="file-path validate" type="text">
      </div>
      <button class="btn" type="submit">Add Trip Picture</button>
    </div>
  </form>
  </div>
    <% end %>

<div class = "container">
	</table>

	<% count = 0 %>
	<% @places.each do |p| %>
	<% count += 1 %>
	<h3>Place #<%= count %></h3>
	<table>
		<% if @picture = Picture.find_by(place_id: p.id) %>
		<div class = 'place_image'><%= image_tag @picture.picture.url %></div> 
		<% end %>
		<tr>
			<td>Location:</td>
			<td><%= p.location %></td>
		</tr>
		<tr>
			<td>Description:</td>
			<td><%= p.description %></td>
		</tr>
		<tr>
			<td>Date:</td>
			<td><%= p.datetime %> </td>
		</tr>
	</table>
	<% end %>
</div>


  </div>
</section>

<section class="module parallax parallax-3">
  <div class="container"><br>
    <h1><%= @trip.destination %></h1>
  </div>
</section>




</body>
</html>